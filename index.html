<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🏠 家庭財務健檢</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入 html2pdf -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <!-- 引入 Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background-color: #fff7ed; /* bg-orange-50 */
        }
        .question-card {
            background-color: white;
            border-radius: 0.75rem; /* 12px */
            padding: 1.5rem; /* 24px */
            margin-bottom: 1.5rem; /* 24px */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }
        .question-item {
            border-bottom: 1px solid #fed7aa; /* orange-200 */
            padding-bottom: 1.5rem; /* 增加底部間距 */
            margin-bottom: 1.5rem; /* 增加底部間距 */
        }
        .question-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        /* --- 評分樣式 --- */
        .rating-container {
            margin-top: 0.5rem;
        }
        .rating-labels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.25rem;
            font-size: 0.75rem; /* 12px */
            color: #6b7280; /* gray-500 */
            padding: 0 0.5rem; /* 對齊星星中心 */
        }
        .rating-labels span {
            flex: 1;
            text-align: center;
        }

        .star-rating {
            display: flex;
            justify-content: space-between;
            flex-direction: row-reverse; /* 讓星星從右到左排列，方便 CSS 選取 */
            padding: 0 0.5rem;
            max-width: 100%; 
        }
        .star-rating input {
            display: none; /* 隱藏原本的 radio button */
        }
        .star-rating label {
            font-size: 1.75rem; /* 加大星星尺寸方便點擊 */
            color: #d1d5db; /* gray-300 (未選中顏色) */
            cursor: pointer;
            transition: color 0.2s;
            flex: 1;
            text-align: center;
            padding: 5px 0; /* 增加點擊區域 */
        }
        /* 滑過或選中時的樣式 (利用兄弟選擇器) */
        .star-rating input:checked ~ label,
        .star-rating label:hover,
        .star-rating label:hover ~ label {
            color: #f88137; /* 指定橘色 */
        }
        
        /* 結果區塊樣式 */
        .result-box {
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-top: 1.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            background-color: white;
            border-width: 2px; 
        }
        
        .result-box-green { border-color: #22c55e; border-top-width: 6px; }
        .result-box-yellow { border-color: #eab308; border-top-width: 6px; }
        .result-box-orange { border-color: #f97316; border-top-width: 6px; }
        .result-box-red { border-color: #ef4444; border-top-width: 6px; }

        .action-plan-list {
            list-style-type: none;
            padding-left: 0;
        }
        /* 修正手機版文字切到問題：加入 word-break 和 overflow-wrap */
        .action-plan-list li {
            position: relative;
            padding-left: 2rem; /* 32px */
            margin-bottom: 0.5rem; /* 8px */
            word-break: break-word;     /* 強制長單字換行 */
            overflow-wrap: break-word;  /* 確保文字在小螢幕上正確換行 */
        }
        .action-plan-list li::before {
            content: '□';
            position: absolute;
            left: 0;
            top: 0;
            font-size: 1.5rem; /* 24px */
            line-height: 1.25;
            color: #9ca3af; /* gray-400 */
        }
        
        /* 動態顯示的個別結果卡片樣式 */
        .section-result {
            background-color: #fff7ed; /* orange-50 */
            border: 1px solid #fed7aa; /* orange-200 */
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
            animation: fadeIn 0.5s ease-in-out;
            font-size: 0.95rem;
            line-height: 1.6;
            color: #431407; /* orange-950 */
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* 彈出視窗樣式 (預設隱藏) */
        #validationModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 100;
            justify-content: center;
            align-items: center;
        }
        #validationContent {
            background-color: white;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            border: 2px solid #f88137;
            text-align: center;
            min-width: 300px;
            max-width: 90%;
        }

        /* 載入中遮罩 */
        #loadingOverlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.9);
            z-index: 200;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        /* 雷達圖容器 */
        .chart-container {
            position: relative;
            margin: auto;
            /* 調整高度以適應手機版，避免過高 */
            height: 350px; 
            width: 100%;
            max-width: 500px;
            margin-bottom: 2rem;
            background-color: white;
            border-radius: 1rem;
            padding: 0.5rem; /* 減少容器內距，讓 Canvas 有更多空間 */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        /* ----------------------------------------------------
           PDF 生成專用樣式 
           (這些樣式只會在產生 PDF 時的複製節點中生效)
        ---------------------------------------------------- */
        .pdf-mode {
            width: 750px !important; /* 調整寬度以更好適應 A4 */
            margin: 0 auto !important;
            padding: 30px !important; /* 減少內邊距 */
            background-color: white !important;
            color: black !important;
            font-family: 'Noto Sans TC', sans-serif !important;
            font-size: 12px !important; /* 縮小預設字體 */
        }
        
        /* 強制不分頁的元素 */
        .pdf-mode .question-card, 
        .pdf-mode .result-box,
        .pdf-mode .section-result,
        .pdf-mode .chart-container,
        .pdf-mode .mb-6 { /* 針對行動計畫的區塊 */
            box-shadow: none !important;
            border: 1px solid #eee !important;
            page-break-inside: avoid !important; /* 關鍵：避免區塊中間斷頁 */
            margin-bottom: 20px !important;
            break-inside: avoid !important;
        }

        .pdf-mode h1 { font-size: 24px !important; color: #f88137 !important; margin-bottom: 10px !important; }
        .pdf-mode h2 { font-size: 18px !important; border-left-width: 4px !important; padding-left: 8px !important; margin-top: 15px !important; margin-bottom: 10px !important; }
        .pdf-mode h3 { font-size: 16px !important; color: #333 !important; margin-bottom: 5px !important; }
        .pdf-mode p, .pdf-mode li { font-size: 12px !important; line-height: 1.4 !important; }
        
        /* 讓建議區塊的紅字正常顯示 */
        .pdf-mode .text-red-600 { color: #dc2626 !important; }
        .pdf-mode .text-green-600 { color: #16a34a !important; }
        
        /* PDF 模式下隱藏不需要的按鈕與輸入區塊，只留結果 */
        .pdf-mode #quizForm,
        .pdf-mode .text-center.my-10, /* 按鈕區 */
        .pdf-mode .rating-container { /* 隱藏星星評分，只留結果文字 */
             display: none !important; 
        }
        
        .pdf-mode header img { 
            max-height: 120px !important;
            object-fit: contain !important;
            margin-bottom: 20px !important;
        }
        
        /* 讓雷達圖在 PDF 中正確顯示 */
        .pdf-mode .chart-container {
            height: auto !important;
            min-height: 350px !important;
            width: 100% !important;
            max-width: 500px !important;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-left: auto !important;
            margin-right: auto !important;
            page-break-before: auto !important; /* 允許圖表前分頁 */
        }
        .pdf-mode img {
            max-width: 100% !important;
            height: auto !important;
        }
        
        /* 針對行動建議列表 */
        .pdf-mode .action-plan-list li {
            margin-bottom: 4px !important;
        }

    </style>
</head>
<body class="text-gray-800">

    <div id="app-container">
        <!-- Header -->
        <header class="w-full mb-6 shadow-sm">
            <div class="w-full h-auto overflow-hidden">
                <img src="banner.jpg" 
                     alt="MomPower Banner" 
                     class="w-full h-auto object-cover max-h-[300px]"
                     crossorigin="anonymous"
                     onerror="this.src='https://placehold.co/1200x400/f88137/ffffff?text=MomPower+Banner';">
            </div>
        </header>

        <main class="max-w-3xl mx-auto p-4 md:p-8">
            <header class="text-center mb-8">
                <h1 class="text-3xl md:text-4xl font-bold text-orange-800 mb-2">🏠 家庭財務健檢</h1>
            </header>

            <!-- 簡介區塊 -->
            <section class="question-card border-t-4 border-[#f88137]">
                <h2 class="text-2xl font-bold text-orange-700 mb-4">你家的財務安全度有幾分？</h2>
                
                <div class="text-gray-700 leading-relaxed space-y-4 text-base md:text-lg">
                    <p>
                        還記得一個人的時候，薪水怎麼花都可以，想買什麼就買什麼都瀟灑自在。但是當媽媽之後，看著帳戶的數字，總覺得心裡不太踏實？

「是不是我賺得不夠多?」、「錢到底都跑去哪裡了?」如果你也有這樣的感覺，我想跟你說，很多媽媽一開始都是這樣的。


                    </p>
                    
                    <p class="font-bold text-orange-800 text-xl py-2">
                        你的擔憂我們懂。
                    </p>
                    
                    <p>
                        MomPower媽媽商學院這幾年，看過太多媽媽都是這樣開始的。所以我們設計了這份<span class="font-bold text-orange-600 text-lg">「家庭財務健檢」</span>，希望用幾分鐘的時間，幫你快速看清楚現在的財務狀況到底怎麼樣，以及找到適合你的學習資源和媽媽社群。不用擔心，這不是考試，只是幫你看清楚自己在哪裡，接下來可以往哪裡走。
                    </p>
                    
                    <div class="bg-orange-50 p-4 rounded-lg border border-orange-100 mt-4">
                        <p class="mb-2">這份量表幫助你了解目前家庭財務的安全程度，並找出可以加強的方向。</p>
                        <p class="font-semibold text-orange-800">
                            請根據家庭目前的真實狀況作答，誠實評估現況。以 <span class="text-orange-600">完全沒有(1分)</span> 至 <span class="text-orange-600">完全具備(5分)</span> 計分。
                        </p>
                    </div>
                </div>
            </section>

            <form id="quizForm">
                <!-- 第一部分 -->
                <h2 class="text-3xl font-bold text-gray-700 mt-10 mb-6 border-l-8 border-[#f88137] pl-4">第一部分：財務基礎與應變能力</h2>

                <!-- A Section -->
                <div class="question-card" id="sectionA">
                    <h3 class="text-xl font-bold text-orange-700 mb-4">A. 收支掌控力</h3>
                    <div class="space-y-4">
                        <div class="question-item">
                            <p class="font-semibold mb-2">清楚知道每月的總收入</p>
                            <!-- 第一題顯示標籤 -->
                            <div class="rating-container">
                                <div class="rating-labels">
                                    <span>完全沒有</span><span>稍微具備</span><span>部分具備</span><span>大致具備</span><span>完全具備</span>
                                </div>
                                <div class="star-rating">
                                    <input type="radio" id="qA1-5" name="qA1" value="5"><label for="qA1-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qA1-4" name="qA1" value="4"><label for="qA1-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qA1-3" name="qA1" value="3"><label for="qA1-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qA1-2" name="qA1" value="2"><label for="qA1-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qA1-1" name="qA1" value="1"><label for="qA1-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">了解每月主要支出項目和金額</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qA2-5" name="qA2" value="5"><label for="qA2-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qA2-4" name="qA2" value="4"><label for="qA2-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qA2-3" name="qA2" value="3"><label for="qA2-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qA2-2" name="qA2" value="2"><label for="qA2-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qA2-1" name="qA2" value="1"><label for="qA2-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">有記帳習慣，知道錢花到哪裡去</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qA3-5" name="qA3" value="5"><label for="qA3-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qA3-4" name="qA3" value="4"><label for="qA3-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qA3-3" name="qA3" value="3"><label for="qA3-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qA3-2" name="qA3" value="2"><label for="qA3-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qA3-1" name="qA3" value="1"><label for="qA3-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">每月支出控制在收入範圍內</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qA4-5" name="qA4" value="5"><label for="qA4-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qA4-4" name="qA4" value="4"><label for="qA4-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qA4-3" name="qA4" value="3"><label for="qA4-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qA4-2" name="qA4" value="2"><label for="qA4-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qA4-1" name="qA4" value="1"><label for="qA4-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">有固定的儲蓄習慣</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qA5-5" name="qA5" value="5"><label for="qA5-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qA5-4" name="qA5" value="4"><label for="qA5-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qA5-3" name="qA5" value="3"><label for="qA5-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qA5-2" name="qA5" value="2"><label for="qA5-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qA5-1" name="qA5" value="1"><label for="qA5-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="text-right text-lg font-bold text-orange-800 mt-6">
                        小計A：<span id="subtotalA">0</span> 分
                    </div>
                    <div id="resultA" class="hidden"></div>
                </div>

                <!-- B Section -->
                <div class="question-card" id="sectionB">
                    <h3 class="text-xl font-bold text-orange-700 mb-4">B. 緊急應變能力</h3>
                    <div class="space-y-4">
                        <div class="question-item">
                            <p class="font-semibold mb-2">有預備好緊急預備金（至少3個月生活費）</p>
                            <div class="rating-container">
                                <div class="rating-labels">
                                    <span>完全沒有</span><span>稍微具備</span><span>部分具備</span><span>大致具備</span><span>完全具備</span>
                                </div>
                                <div class="star-rating">
                                    <input type="radio" id="qB1-5" name="qB1" value="5"><label for="qB1-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qB1-4" name="qB1" value="4"><label for="qB1-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qB1-3" name="qB1" value="3"><label for="qB1-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qB1-2" name="qB1" value="2"><label for="qB1-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qB1-1" name="qB1" value="1"><label for="qB1-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">如果遇到突發狀況，財務面不會手忙腳亂</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qB2-5" name="qB2" value="5"><label for="qB2-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qB2-4" name="qB2" value="4"><label for="qB2-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qB2-3" name="qB2" value="3"><label for="qB2-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qB2-2" name="qB2" value="2"><label for="qB2-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qB2-1" name="qB2" value="1"><label for="qB2-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">財務遇到緊急狀況時，知道可以向誰求助</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qB3-5" name="qB3" value="5"><label for="qB3-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qB3-4" name="qB3" value="4"><label for="qB3-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qB3-3" name="qB3" value="3"><label for="qB3-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qB3-2" name="qB3" value="2"><label for="qB3-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qB3-1" name="qB3" value="1"><label for="qB3-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">有多元化的收入來源規劃</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qB4-5" name="qB4" value="5"><label for="qB4-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qB4-4" name="qB4" value="4"><label for="qB4-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qB4-3" name="qB4" value="3"><label for="qB4-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qB4-2" name="qB4" value="2"><label for="qB4-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qB4-1" name="qB4" value="1"><label for="qB4-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">家庭主要收入者有基本保險保障</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qB5-5" name="qB5" value="5"><label for="qB5-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qB5-4" name="qB5" value="4"><label for="qB5-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qB5-3" name="qB5" value="3"><label for="qB5-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qB5-2" name="qB5" value="2"><label for="qB5-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qB5-1" name="qB5" value="1"><label for="qB5-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="text-right text-lg font-bold text-orange-800 mt-6">
                        小計B：<span id="subtotalB">0</span> 分
                    </div>
                    <div id="resultB" class="hidden"></div>
                </div>

                <!-- C Section -->
                <div class="question-card" id="sectionC">
                    <h3 class="text-xl font-bold text-orange-700 mb-4">C. 未來規劃準備度</h3>
                    <div class="space-y-4">
                        <div class="question-item">
                            <p class="font-semibold mb-2">有為孩子準備教育基金</p>
                            <div class="rating-container">
                                <div class="rating-labels">
                                    <span>完全沒有</span><span>稍微具備</span><span>部分具備</span><span>大致具備</span><span>完全具備</span>
                                </div>
                                <div class="star-rating">
                                    <input type="radio" id="qC1-5" name="qC1" value="5"><label for="qC1-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qC1-4" name="qC1" value="4"><label for="qC1-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qC1-3" name="qC1" value="3"><label for="qC1-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qC1-2" name="qC1" value="2"><label for="qC1-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qC1-1" name="qC1" value="1"><label for="qC1-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">開始為退休做財務準備</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qC2-5" name="qC2" value="5"><label for="qC2-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qC2-4" name="qC2" value="4"><label for="qC2-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qC2-3" name="qC2" value="3"><label for="qC2-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qC2-2" name="qC2" value="2"><label for="qC2-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qC2-1" name="qC2" value="1"><label for="qC2-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">了解基本的投資理財概念</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qC3-5" name="qC3" value="5"><label for="qC3-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qC3-4" name="qC3" value="4"><label for="qC3-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qC3-3" name="qC3" value="3"><label for="qC3-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qC3-2" name="qC3" value="2"><label for="qC3-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qC3-1" name="qC3" value="1"><label for="qC3-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">有長期的財務目標設定</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qC4-5" name="qC4" value="5"><label for="qC4-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qC4-4" name="qC4" value="4"><label for="qC4-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qC4-3" name="qC4" value="3"><label for="qC4-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qC4-2" name="qC4" value="2"><label for="qC4-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qC4-1" name="qC4" value="1"><label for="qC4-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">定期檢視和調整理財計畫</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qC5-5" name="qC5" value="5"><label for="qC5-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qC5-4" name="qC5" value="4"><label for="qC5-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qC5-3" name="qC5" value="3"><label for="qC5-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qC5-2" name="qC5" value="2"><label for="qC5-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qC5-1" name="qC5" value="1"><label for="qC5-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="text-right text-lg font-bold text-orange-800 mt-6">
                        小計C：<span id="subtotalC">0</span> 分
                    </div>
                    <div id="resultC" class="hidden"></div>
                </div>

                <!-- 第二部分 -->
                <h2 class="text-3xl font-bold text-gray-700 mt-10 mb-6 border-l-8 border-[#f88137] pl-4">第二部分：財務安全感與外部資源</h2>

                <!-- D Section -->
                <div class="question-card" id="sectionD">
                    <h3 class="text-xl font-bold text-orange-700 mb-4">D. 金錢安心感</h3>
                    <div class="space-y-4">
                        <div class="question-item">
                            <p class="font-semibold mb-2">對目前的財務狀況感到踏實</p>
                            <div class="rating-container">
                                <div class="rating-labels">
                                    <span>完全沒有</span><span>稍微具備</span><span>部分具備</span><span>大致具備</span><span>完全具備</span>
                                </div>
                                <div class="star-rating">
                                    <input type="radio" id="qD1-5" name="qD1" value="5"><label for="qD1-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qD1-4" name="qD1" value="4"><label for="qD1-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qD1-3" name="qD1" value="3"><label for="qD1-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qD1-2" name="qD1" value="2"><label for="qD1-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qD1-1" name="qD1" value="1"><label for="qD1-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">不會因為金錢問題而經常失眠</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qD2-5" name="qD2" value="5"><label for="qD2-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qD2-4" name="qD2" value="4"><label for="qD2-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qD2-3" name="qD2" value="3"><label for="qD2-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qD2-2" name="qD2" value="2"><label for="qD2-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qD2-1" name="qD2" value="1"><label for="qD2-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">面對意外支出不會影響心情</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qD3-5" name="qD3" value="5"><label for="qD3-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qD3-4" name="qD3" value="4"><label for="qD3-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qD3-3" name="qD3" value="3"><label for="qD3-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qD3-2" name="qD3" value="2"><label for="qD3-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qD3-1" name="qD3" value="1"><label for="qD3-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">相信自己有能力管理家庭財務</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qD4-5" name="qD4" value="5"><label for="qD4-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qD4-4" name="qD4" value="4"><label for="qD4-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qD4-3" name="qD4" value="3"><label for="qD4-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qD4-2" name="qD4" value="2"><label for="qD4-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qD4-1" name="qD4" value="1"><label for="qD4-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">對未來的經濟生活有信心</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qD5-5" name="qD5" value="5"><label for="qD5-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qD5-4" name="qD5" value="4"><label for="qD5-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qD5-3" name="qD5" value="3"><label for="qD5-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qD5-2" name="qD5" value="2"><label for="qD5-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qD5-1" name="qD5" value="1"><label for="qD5-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="text-right text-lg font-bold text-orange-800 mt-6">
                        小計D：<span id="subtotalD">0</span> 分
                    </div>
                    <div id="resultD" class="hidden"></div>
                </div>

                <!-- E Section -->
                <div class="question-card" id="sectionE">
                    <h3 class="text-xl font-bold text-orange-700 mb-4">E. 理財知識開放度</h3>
                    <div class="space-y-4">
                        <div class="question-item">
                            <p class="font-semibold mb-2">基本理解常見的理財工具</p>
                            <div class="rating-container">
                                <div class="rating-labels">
                                    <span>完全沒有</span><span>稍微具備</span><span>部分具備</span><span>大致具備</span><span>完全具備</span>
                                </div>
                                <div class="star-rating">
                                    <input type="radio" id="qE1-5" name="qE1" value="5"><label for="qE1-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qE1-4" name="qE1" value="4"><label for="qE1-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qE1-3" name="qE1" value="3"><label for="qE1-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qE1-2" name="qE1" value="2"><label for="qE1-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qE1-1" name="qE1" value="1"><label for="qE1-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">對於投資配置方式，自己有一套邏輯</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qE2-5" name="qE2" value="5"><label for="qE2-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qE2-4" name="qE2" value="4"><label for="qE2-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qE2-3" name="qE2" value="3"><label for="qE2-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qE2-2" name="qE2" value="2"><label for="qE2-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qE2-1" name="qE2" value="1"><label for="qE2-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">對於新的投資資訊，有自己的辨識方式</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qE3-5" name="qE3" value="5"><label for="qE3-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qE3-4" name="qE3" value="4"><label for="qE3-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qE3-3" name="qE3" value="3"><label for="qE3-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qE3-2" name="qE3" value="2"><label for="qE3-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qE3-1" name="qE3" value="1"><label for="qE3-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">身邊有朋友圈或學習圈可以共同討論理財投資問題</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qE4-5" name="qE4" value="5"><label for="qE4-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qE4-4" name="qE4" value="4"><label for="qE4-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qE4-3" name="qE4" value="3"><label for="qE4-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qE4-2" name="qE4" value="2"><label for="qE4-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qE4-1" name="qE4" value="1"><label for="qE4-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">對於理財投資新的資訊抱持的開放態度了解</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qE5-5" name="qE5" value="5"><label for="qE5-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qE5-4" name="qE5" value="4"><label for="qE5-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qE5-3" name="qE5" value="3"><label for="qE5-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qE5-2" name="qE5" value="2"><label for="qE5-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qE5-1" name="qE5" value="1"><label for="qE5-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="text-right text-lg font-bold text-orange-800 mt-6">
                        小計E：<span id="subtotalE">0</span> 分
                    </div>
                    <div id="resultE" class="hidden"></div>
                </div>

                <!-- F Section -->
                <div class="question-card" id="sectionF">
                    <h3 class="text-xl font-bold text-orange-700 mb-4">F. 家庭財務溝通</h3>
                    <div class="space-y-4">
                        <div class="question-item">
                            <p class="font-semibold mb-2">和伴侶能夠開誠布公討論金錢</p>
                            <div class="rating-container">
                                <div class="rating-labels">
                                    <span>完全沒有</span><span>稍微具備</span><span>部分具備</span><span>大致具備</span><span>完全具備</span>
                                </div>
                                <div class="star-rating">
                                    <input type="radio" id="qF1-5" name="qF1" value="5"><label for="qF1-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qF1-4" name="qF1" value="4"><label for="qF1-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qF1-3" name="qF1" value="3"><label for="qF1-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qF1-2" name="qF1" value="2"><label for="qF1-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qF1-1" name="qF1" value="1"><label for="qF1-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">家庭重大支出會一起商量決定</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qF2-5" name="qF2" value="5"><label for="qF2-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qF2-4" name="qF2" value="4"><label for="qF2-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qF2-3" name="qF2" value="3"><label for="qF2-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qF2-2" name="qF2" value="2"><label for="qF2-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qF2-1" name="qF2" value="1"><label for="qF2-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">對家庭財務分工有清楚共識</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qF3-5" name="qF3" value="5"><label for="qF3-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qF3-4" name="qF3" value="4"><label for="qF3-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qF3-3" name="qF3" value="3"><label for="qF3-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qF3-2" name="qF3" value="2"><label for="qF3-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qF3-1" name="qF3" value="1"><label for="qF3-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">能夠理性處理金錢相關的分歧</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qF4-5" name="qF4" value="5"><label for="qF4-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qF4-4" name="qF4" value="4"><label for="qF4-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qF4-3" name="qF4" value="3"><label for="qF4-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qF4-2" name="qF4" value="2"><label for="qF4-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qF4-1" name="qF4" value="1"><label for="qF4-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">對孩子教育使用金錢方式有共同理念</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qF5-5" name="qF5" value="5"><label for="qF5-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qF5-4" name="qF5" value="4"><label for="qF5-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qF5-3" name="qF5" value="3"><label for="qF5-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qF5-2" name="qF5" value="2"><label for="qF5-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qF5-1" name="qF5" value="1"><label for="qF5-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="text-right text-lg font-bold text-orange-800 mt-6">
                        小計F：<span id="subtotalF">0</span> 分
                    </div>
                    <div id="resultF" class="hidden"></div>
                </div>

                <!-- G Section -->
                <div class="question-card" id="sectionG">
                    <h3 class="text-xl font-bold text-orange-700 mb-4">G. 外部支持系統</h3>
                    <div class="space-y-4">
                        <div class="question-item">
                            <p class="font-semibold mb-2">對意外狀況，家人可以互相討論或支援</p>
                            <div class="rating-container">
                                <div class="rating-labels">
                                    <span>完全沒有</span><span>稍微具備</span><span>部分具備</span><span>大致具備</span><span>完全具備</span>
                                </div>
                                <div class="star-rating">
                                    <input type="radio" id="qG1-5" name="qG1" value="5"><label for="qG1-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qG1-4" name="qG1" value="4"><label for="qG1-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qG1-3" name="qG1" value="3"><label for="qG1-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qG1-2" name="qG1" value="2"><label for="qG1-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qG1-1" name="qG1" value="1"><label for="qG1-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">有長期往來互動良好的銀行資源</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qG2-5" name="qG2" value="5"><label for="qG2-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qG2-4" name="qG2" value="4"><label for="qG2-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qG2-3" name="qG2" value="3"><label for="qG2-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qG2-2" name="qG2" value="2"><label for="qG2-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qG2-1" name="qG2" value="1"><label for="qG2-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">身邊有好的學習社群和專業顧問</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qG3-5" name="qG3" value="5"><label for="qG3-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qG3-4" name="qG3" value="4"><label for="qG3-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qG3-3" name="qG3" value="3"><label for="qG3-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qG3-2" name="qG3" value="2"><label for="qG3-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qG3-1" name="qG3" value="1"><label for="qG3-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">有了解並善用政策提供的資源</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qG4-5" name="qG4" value="5"><label for="qG4-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qG4-4" name="qG4" value="4"><label for="qG4-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qG4-3" name="qG4" value="3"><label for="qG4-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qG4-2" name="qG4" value="2"><label for="qG4-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qG4-1" name="qG4" value="1"><label for="qG4-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                        <div class="question-item">
                            <p class="font-semibold mb-2">常常有在觀看留意新的財經資訊</p>
                            <div class="rating-container">
                                <div class="star-rating">
                                    <input type="radio" id="qG5-5" name="qG5" value="5"><label for="qG5-5"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qG5-4" name="qG5" value="4"><label for="qG5-4"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qG5-3" name="qG5" value="3"><label for="qG5-3"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qG5-2" name="qG5" value="2"><label for="qG5-2"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="qG5-1" name="qG5" value="1"><label for="qG5-1"><i class="fas fa-star"></i></label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="text-right text-lg font-bold text-orange-800 mt-6">
                        小計G：<span id="subtotalG">0</span> 分
                    </div>
                    <div id="resultG" class="hidden"></div>
                </div>
            </form>

            <div class="text-center my-10 flex flex-wrap gap-4 justify-center" data-html2canvas-ignore="true">
                <button id="calculateButton" class="bg-[#f88137] text-white font-bold py-3 px-8 rounded-full text-lg shadow-lg hover:bg-orange-600 transition duration-300 transform hover:scale-105">
                    📊 查看我的財務健檢分析
                </button>
                <button id="downloadButton" class="hidden bg-green-600 text-white font-bold py-3 px-8 rounded-full text-lg shadow-lg hover:bg-green-700 transition duration-300 transform hover:scale-105 flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                    下載分析報告 (PDF)
                </button>
                <button id="resetButton" class="bg-gray-300 text-gray-700 font-bold py-3 px-8 rounded-full text-lg shadow-lg hover:bg-gray-400 transition duration-300">
                    ↻ 重新填寫
                </button>
            </div>

            <!-- 結果顯示區塊 -->
            <div id="results" class="hidden">
                <!-- 雷達圖將會顯示在這裡 -->
            </div>

            <section id="actionPlanSection" class="question-card mt-10 border-t-4 border-green-500 hidden">
                <h2 class="text-2xl font-bold text-green-700 mb-4">💪 提升財務安全度的行動計畫</h2>
                
                <div class="mb-6">
                    <h3 class="font-bold text-lg text-gray-800 mb-2 flex items-center gap-2">
                        <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                        現在就可以做的事：
                    </h3>
                    <ul class="action-plan-list text-gray-700 space-y-2 ml-2">
                        <li>開始記錄一週的支出，先看看錢都去哪了</li>
                        <li>給自己設定第一個小小的儲蓄目標</li>
                        <li>加入<a href="https://lihi.cc/QRKPx" target="_blank" class="text-orange-600 hover:underline font-bold">8週存款成長營</a>LINE社群，每週三中午有實用分享</li>
                        <li>跟家人聊聊這份檢測結果，一起面對會比較輕鬆</li>
                    </ul>
                </div>

                <div class="mb-6">
                    <h3 class="font-bold text-lg text-gray-800 mb-2 flex items-center gap-2">
                        <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                        一個月內可做的事：
                    </h3>
                    <ul class="action-plan-list text-gray-700 space-y-2 ml-2">
                        <li>把記帳變成習慣，不用完美，持續就好</li>
                        <li>存下第一筆緊急預備金，金額不用多</li>
                        <li>看看家裡的基本保險狀況，有沒有需要補強的</li>
                        <li>想一個明確的理財目標，有方向才知道怎麼走</li>
                        <li>看看<a href="https://mompower.kaik.to/savemoney/test" target="_blank" class="text-orange-600 hover:underline font-bold">家庭理財必修課</a>，建立正確且完整的財商知識</li>
                        <li>考慮<a href="https://mompower.kaik.to/track-plan/test" target="_blank" class="text-orange-600 hover:underline font-bold">60天存款成長計畫</a>，讓教練陪你建立習慣、檢視預算和資產</li>
                    </ul>
                </div>

                <div>
                    <h3 class="font-bold text-lg text-gray-800 mb-2 flex items-center gap-2">
                        <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                        三個月內可做的事：
                    </h3>
                    <ul class="action-plan-list text-gray-700 space-y-2 ml-2">
                        <li>儲蓄已經成為一種自然的習慣</li>
                        <li>開始了解基本的投資理財概念</li>
                        <li>跟家人談錢變得比較順暢了</li>
                        <li>可以考慮專業的理財服務或課程</li>
                        <li>看看<a href="https://mompower.kaik.to/momfinance/test" target="_blank" class="text-orange-600 hover:underline font-bold">幸福家庭財務長</a>，認識更多理財工具</li>
                        <li>如果想把家庭理財變成一門專業，<a href="https://mompower.kaik.to/60days-coaching/test" target="_blank" class="text-orange-600 hover:underline font-bold">陪跑教練培訓營</a>可以幫你創造收入</li>
                    </ul>
                </div>
            </section>

            <section id="encouragementSection" class="question-card bg-orange-50 text-center border border-orange-100 hidden">
                <h2 class="text-2xl font-bold text-orange-700 mb-4">🌟 MomPower給的愛的鼓勵</h2>
                <div class="text-orange-800 leading-relaxed mb-4 space-y-4 text-left md:text-center">
                    <p>親愛的媽媽，財務安全真的不是一天、兩天就能建立起來的，但我想跟你說，每一個小小的行動，都在讓你的家庭變得更安全一點點。</p>
                    <p>無論你現在的分數是多少，光是你願意停下來檢視財務狀況，就已經很棒了，因為很多人連面對都不敢，但你做到了。</p>
                    <p>每個家庭的起點本來就不同，不要跟別人比，專注在自己的進步就好。財務安全是一個過程，不是終點，慢慢來、一步一步走，沒有人天生就會理財的。你已經在往前走了，這本身就很值得肯定。</p>
                    <p>你已經是個很努力、很棒的媽媽了，真的。如果你需要更多支持和陪伴，我們隨時都在這裡。讓我們一起為家庭建立更穩固的財務安全網！💪</p>
                </div>
                <div class="mt-8 pt-6 border-t border-orange-200 text-gray-600 text-sm">
                    <p class="mb-4">這份家庭財務健檢量表是一個自我了解的工具，幫助你找到改善方向。</p>
                    <p class="mb-4">如果面臨嚴重的財務困難，建議尋求專業的財務規劃協助。</p>
                    <p class="font-bold text-orange-800 text-base mb-4">歡迎加入MomPower 官方Line:@mompower 獲得免費個別諮詢或推薦優惠!</p>
                </div>
                <div class="text-center mb-4" data-html2canvas-ignore="true">
                    <a href="https://lin.ee/y4tWjhe" target="_blank" class="inline-flex items-center justify-center gap-2 bg-[#06C755] text-white px-6 py-3 rounded-full font-bold shadow-lg hover:bg-[#05b34c] transition transform hover:scale-105 no-underline">
                        <i class="fab fa-line text-2xl"></i>
                        加入 MomPower 官方 Line@ 諮詢
                    </a>
                </div>
            </section>

            <footer class="text-center mt-8 text-gray-500 text-sm pb-8 border-t border-orange-200 pt-6">
                <p>&copy; 2025 MomPower 媽媽商學院. All Rights Reserved.</p>
            </footer>
        </div>

        <!-- 彈出視窗 -->
        <div id="validationModal">
            <div id="validationContent">
                <p class="text-lg font-bold text-red-700 mb-3 text-center">請回答所有的問題，才能產生準確的分析報告喔！</p>
                <div class="bg-orange-50 p-4 rounded-lg border border-orange-200 mb-4">
                    <p class="font-bold text-gray-700 mb-2">👇 以下部分尚未完成：</p>
                    <div id="validationList" class="text-left pl-2"></div>
                </div>
                <button id="closeValidationModal" class="bg-[#f88137] text-white py-2 px-8 rounded-full font-bold hover:bg-orange-600 transition shadow-md">
                    了解，繼續填寫
                </button>
            </div>
        </div>

        <div id="loadingOverlay">
            <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-orange-500 mb-4"></div>
            <p class="text-orange-700 font-bold text-xl">正在產生您的專屬報告...</p>
        </div>

    </div>

    <script>
        // 詳細的分析建議資料 (保留完整內容)
        const adviceData = {
            A: [
                { min: 5, max: 12, desc: "目前對家庭收支不夠清楚，容易出現「錢不知花到哪裡」的狀況。", action: "從記帳開始，先掌握每月現金流。" },
                { min: 13, max: 16, desc: "已開始留意收支，但發現不知為何常常超出預算。", action: "嘗試設定每月「可支出上限」，建立花費預算表。" },
                { min: 16, max: 20, desc: "已有基礎的收支紀錄與儲蓄習慣。", action: "可開始進一步做「收支比例分析」（例如固定支出40%、儲蓄20%）。" },
                { min: 21, max: 25, desc: "收支明確、儲蓄穩定，財務流向清楚。", action: "可嘗試規劃家庭年度預算或財務目標表，強化策略性管理。" }
            ],
            B: [
                { min: 5, max: 9, desc: "無任何財務安全網，一但發生意外支出就會衝擊到生活。", action: "優先存下第一筆 1～3 個月生活費，並檢視保險配置。" },
                { min: 10, max: 15, desc: "有基本儲蓄可做緊急預備金，但仍不夠應付收入中斷問題。", action: "建立「緊急資金帳戶」，並針對主要收入者做基礎保險規劃。" },
                { min: 16, max: 20, desc: "已有預備金與保險概念，但收入偏單一需要創造更多收入。", action: "可強化收入多元化，如副業或被動收入。" },
                { min: 21, max: 25, desc: "財務安全網完善，風險應變力強。", action: "可進一步學習「保障與投資平衡策略」，讓風險更有彈性。" }
            ],
            C: [
                { min: 5, max: 9, desc: "尚未開始退休或教育基金規劃。", action: "從設定「未來三年目標」開始，例如為孩子開教育帳戶。" },
                { min: 10, max: 15, desc: "有模糊的長期想法，但尚未行動。", action: "寫下具體的金額與時間目標，並嘗試每月小額投資。" },
                { min: 16, max: 20, desc: "已開始規劃退休或子女教育基金。", action: "可增加投資多樣化，學習資產配置概念。" },
                { min: 21, max: 25, desc: "長期財務規劃明確且穩定執行。", action: "定期檢視投資報酬與風險，進一步學習傳承與稅務策略。" }
            ],
            D: [
                { min: 5, max: 9, desc: "陷入過度焦慮金錢與擔心未來，覺得自己都做不好。", action: "練習「感恩日記」減緩焦慮，才有力氣逐步調整財務狀況。" },
                { min: 10, max: 15, desc: "不知道自己預備的夠不夠，所以對財務仍有極大的不安全感。", action: "針對自己沒有安全感的地方去量化數字，並制定適合自己的計畫。" },
                { min: 16, max: 19, desc: "對財務大致安心，但不在計畫內的變化還是會影響心情。", action: "檢視突發事件，只要拉長時間不會影響大方向，就不要太過焦慮。" },
                { min: 20, max: 25, desc: "有充分的思考預備，並且金錢觀健康、內心強大穩定。", action: "可分享經驗，幫助其他媽媽學習面對不同的財務狀況，都要健康面對。" }
            ],
            E: [
                { min: 5, max: 8, desc: "對於「投資」抱有負面想法，因此抗拒去了解。", action: "先了解自己抗拒投資的原因是什麼，以及思考投資對自己為何重要。" },
                { min: 9, max: 11, desc: "投資配置方式偏保守為主，以大盤走勢為主要投資標的。", action: "針對自己的家庭財務現在及未來需要做好整體規劃，針對不足的部分需要加強規劃。" },
                { min: 12, max: 16, desc: "對於新的投資模式相對開放，有在嘗試一些不同的投資工具。", action: "家庭財務需要，建議仍以大盤走勢偏保守方式作為主要配置方式達成，在不影響家庭安全為前提，去嘗試不同投資工具。" },
                { min: 17, max: 25, desc: "樂於嘗試新的工具，有很有自己的投資想法。", action: "有意識的冒險可以為你帶來更多收入，但追求高報酬的同時，對於家庭的財務需要，建議還是要以安全穩健的配置為主。" }
            ],
            F: [
                { min: 5, max: 11, desc: "家裡很少討論金錢話題，每次討論就容易引發爭執或回避。", action: "先不改變他人，先建立自己正確的金錢使用觀念為主。" },
                { min: 12, max: 16, desc: "遇到問題才溝通，但知道有很多區塊暫時沒共識，所以支出有分工但沒有長期財務規劃。", action: "建立安全的金錢對話空間，從「問題溝通」轉為「計畫溝通」。" },
                { min: 17, max: 21, desc: "可以與另外一伴和孩子健康的談論錢的議題，並且都能建立共識。", action: "可邀伴侶一起設定共同討論長期的財務目標規劃，並討論該如何共同完成。" },
                { min: 22, max: 25, desc: "與另外一伴和孩子都有良好的金錢習慣與規劃。", action: "可以更有意識的建立家庭理財文化，並引導孩子的財商教育。" }
            ],
            G: [
                { min: 5, max: 9, desc: "幾乎沒有外部支援，面對財務問題常感到孤單、無從求助。", action: "針對自己的財務弱項，先了解是否有立即可以使用的外部資源。" },
                { min: 10, max: 15, desc: "有一些外部管道，但沒有實際的去深入了解或使用。", action: "針對自己目前的財務階段，找到適合自己的學習團體。" },
                { min: 16, max: 20, desc: "有相關的學習管道或專業顧問可詢問，也有善用銀行或政府資源。", action: "做好家庭財務藍圖規劃，針對自己的需要階段性主動對接資源。" },
                { min: 21, max: 25, desc: "擁有完整的外部支援網絡，能針對不同情況去運用各方資源。", action: "主動幫助他人連結資源，成為社群中的分享者，擴大影響力，成為資源節點。" }
            ]
        };

        // 產品連結
        const productLinks = {
            "8週存款成長營": "https://lihi.cc/QRKPx",
            "家計力聊書會": "https://mompower.kaik.to/fqbook/test",
            "家庭財富8金鑰": "https://mompower.kaik.to/8basic-finance/test",
            "家庭理財必修課": "https://mompower.kaik.to/savemoney/test",
            "幸福家庭財務長": "https://mompower.kaik.to/momfinance/test",
            "60天存款成長計畫": "https://mompower.kaik.to/track-plan/test",
            "陪跑教練培訓營": "https://mompower.kaik.to/60days-coaching/test",
            "精算媽咪的家計簿 Podcast": "https://sandytwo.com/podcast/"
        };

        function createLink(text, key) {
            const url = productLinks[key];
            if (url) {
                const baseUrl = url.replace(/\/test\/?$/, '');
                return `<a href="${baseUrl}" target="_blank" class="text-orange-600 hover:underline font-semibold">${text}</a>`;
            }
            return text;
        }

        // 根據分數獲取建議
        function getAdvice(section, score) {
            const sectionAdvice = adviceData[section];
            if (!sectionAdvice) return null;
            return sectionAdvice.find(a => score >= a.min && score <= a.max);
        }

        // 監聽所有 radio 變動
        document.querySelectorAll('#quizForm input[type="radio"]').forEach(radio => {
            radio.addEventListener('change', updateSubtotals);
        });

        function updateSubtotals() {
            ['A', 'B', 'C', 'D', 'E', 'F', 'G'].forEach(section => {
                const result = calculateSection(section, 5);
                document.getElementById(`subtotal${section}`).textContent = result.total;
            });
        }

        function calculateSection(sectionId, numQuestions) {
            let total = 0;
            const sectionElement = document.getElementById(`section${sectionId}`);
            const checkedRadios = sectionElement.querySelectorAll('input[type="radio"]:checked');
            
            checkedRadios.forEach(radio => {
                total += parseInt(radio.value, 10);
            });
            
            return { total: total, answered: checkedRadios.length === numQuestions };
        }

        // 計算按鈕
        document.getElementById('calculateButton').addEventListener('click', showResults);
        
        // 複製元素並渲染 PDF
        function generatePDF() {
            const loadingOverlay = document.getElementById('loadingOverlay');
            loadingOverlay.style.display = 'flex';

            // 1. 抓取要截圖的容器
            const element = document.getElementById('app-container');

            // 2. 複製一份節點，避免修改到原始畫面
            const clone = element.cloneNode(true);
            
            // 3. 處理 Canvas：將雷達圖轉換為圖片並替換
            const originalCanvas = document.getElementById('radarChart');
            if (originalCanvas) {
                // 將 canvas 轉為 dataURL 圖片
                const chartImage = originalCanvas.toDataURL('image/png');
                
                // 找到複本中的 canvas 父容器
                const clonedChartContainer = clone.querySelector('.chart-container');
                if (clonedChartContainer) {
                    // 清空容器內容
                    clonedChartContainer.innerHTML = '';
                    
                    // 建立圖片元素
                    const img = document.createElement('img');
                    img.src = chartImage;
                    // 加入圖片到複本中
                    clonedChartContainer.appendChild(img);
                }
            }

            // 4. 對複本套用「PDF 模式」樣式
            clone.classList.add('pdf-mode');
            
            // 將複本暫時加入 body (設為絕對定位，讓使用者看不到但瀏覽器渲染得到)
            const container = document.createElement('div');
            container.style.position = 'absolute';
            container.style.top = '-9999px';
            container.style.left = '-9999px';
            container.appendChild(clone);
            document.body.appendChild(container);

            // 5. 設定 html2pdf 參數
            const opt = {
                margin:       [0.5, 0.5], // 上下左右邊距 (英吋)
                filename:     'MomPower_家庭財務健檢報告.pdf',
                image:        { type: 'jpeg', quality: 0.98 },
                html2canvas:  { scale: 2, useCORS: true, scrollY: 0 },
                jsPDF:        { unit: 'in', format: 'a4', orientation: 'portrait' },
                pagebreak:    { mode: ['avoid-all', 'css', 'legacy'] } // 避免切斷元素
            };

            // 6. 對「複本」進行截圖
            html2pdf().set(opt).from(clone).save().then(() => {
                loadingOverlay.style.display = 'none';
                // 移除複本
                document.body.removeChild(container);
            }).catch(err => {
                console.error(err);
                loadingOverlay.style.display = 'none';
                document.body.removeChild(container);
                alert('PDF 產生失敗，請聯繫網站管理員。');
            });
        }

        document.getElementById('downloadButton').addEventListener('click', generatePDF);

        // 重設按鈕
        document.getElementById('resetButton').addEventListener('click', () => {
            document.getElementById('quizForm').reset();
            updateSubtotals();
            document.getElementById('results').innerHTML = '';
            document.getElementById('results').classList.add('hidden');
            
            // 隱藏所有個別分析區塊
            ['A', 'B', 'C', 'D', 'E', 'F', 'G'].forEach(section => {
                const container = document.getElementById(`result${section}`);
                container.innerHTML = '';
                container.classList.add('hidden');
            });

            // 隱藏額外建議區塊
            document.getElementById('actionPlanSection').classList.add('hidden');
            document.getElementById('encouragementSection').classList.add('hidden');

            // 隱藏下載按鈕
            document.getElementById('downloadButton').classList.add('hidden');

            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // 關閉驗證視窗
        document.getElementById('closeValidationModal').addEventListener('click', () => {
            document.getElementById('validationModal').style.display = 'none';
        });

        let radarChartInstance = null; // 儲存圖表實例

        function showResults() {
            let specificAdvice = ''; 

            const sections = ['A', 'B', 'C', 'D', 'E', 'F', 'G'];
            const sectionTitles = {
                'A': 'A. 收支掌控力',
                'B': 'B. 緊急應變能力',
                'C': 'C. 未來規劃準備度',
                'D': 'D. 金錢安心感',
                'E': 'E. 理財知識開放度',
                'F': 'F. 家庭財務溝通',
                'G': 'G. 外部支持系統'
            };
            const scores = {};
            let missingDetails = [];

            // 驗證每個區塊是否有缺漏
            sections.forEach(section => {
                const sectionEl = document.getElementById(`section${section}`);
                const items = sectionEl.querySelectorAll('.question-item');
                let missingCount = 0;
                
                items.forEach(item => {
                    if (!item.querySelector('input[type="radio"]:checked')) {
                        missingCount++;
                    }
                });

                if (missingCount > 0) {
                    missingDetails.push(`${sectionTitles[section]} <span class="text-red-500 font-bold ml-1">(${missingCount} 題未填)</span>`);
                }

                scores[section] = calculateSection(section, 5);
            });

            // 如果有缺漏，顯示詳細錯誤訊息
            if (missingDetails.length > 0) {
                const listContainer = document.getElementById('validationList');
                listContainer.innerHTML = `
                    <ul class='list-disc list-inside text-gray-700 space-y-1 ml-1'>
                        ${missingDetails.map(detail => `<li class='border-b border-orange-100 pb-1 last:border-0'>${detail}</li>`).join('')}
                    </ul>
                `;
                document.getElementById('validationModal').style.display = 'flex';
                return;
            }

            // 1. 顯示個別區塊的分析建議
            sections.forEach(section => {
                const score = scores[section].total;
                const advice = getAdvice(section, score);
                const container = document.getElementById(`result${section}`);
                
                if (advice) {
                    // 取得區塊標題名稱 (去除前面的 "X. " 部分)
                    const sectionName = sectionTitles[section].split(' ')[1];

                    container.innerHTML = `
                        <div class="section-result text-left p-4 bg-white border border-orange-200 rounded-lg shadow-sm mt-4">
                            <p class="font-bold text-orange-800 text-lg mb-2">您的${sectionName}得分為 ${score} 分 (總分25分)</p>
                            <p class="mb-2 text-gray-700"><span class="font-bold text-[#431407]">代表您：</span>${advice.desc}</p>
                            <p class="text-gray-800"><span class="font-bold text-green-600">行動建議 > </span>${advice.action}</p>
                        </div>
                    `;
                    container.classList.remove('hidden');
                }
            });

            // 2. 計算總分並顯示總體分析
            const grandTotal = Object.values(scores).reduce((sum, s) => sum + s.total, 0);
            let resultHTML = '';
            let analysisHTML = '';
            let analysisClass = '';

            // 更新後的分數邏輯 (需關注: 25-50, 待加強: 50-70, 良好: 70-90, 優秀: 90-175)
            // 注意：總分最高是 25 * 7 = 175 分
            if (grandTotal >= 90) {
                analysisClass = 'result-box-green';
                analysisHTML = `
                    <h2 class="text-2xl font-bold text-green-700 mb-2 flex items-center gap-2">
                        <span class="text-3xl">🟢</span> 財務安全度：優秀 (總分 ${grandTotal} 分)
                    </h2>
                    <p class="text-lg font-semibold text-green-800 mb-4 border-b border-green-100 pb-2">哇，你做得真的很好！看到你的分數，我真心替你開心。</p>
                    <h3 class="font-bold text-green-700 mb-2">你現在的狀態是：</h3>
                    <ul class="list-disc list-inside text-green-800 space-y-1 mb-4 bg-green-50 p-3 rounded">
                        <li>財務基礎很穩，心理狀態也很健康</li>
                        <li>養成了很好的理財習慣，也懂得怎麼規劃</li>
                        <li>遇到突發狀況時，有足夠的能力應對</li>
                    </ul>
                    <h3 class="font-bold text-green-700 mb-2">如果你想更進一步：</h3>
                    <ul class="list-disc list-inside text-green-800 space-y-1">
                        <li>可以考慮更進階的學習，像是 ${createLink('幸福家庭財務長', '幸福家庭財務長')}，讓自己的財務規劃更上一層樓</li>
                        <li>其實你的經驗很寶貴，如果想幫助其他媽媽，也能創造收入，可以看看 ${createLink('陪跑教練培訓營', '陪跑教練培訓營')}</li>
                        <li>記得定期檢視一下現有的理財策略，看看有沒有可以優化的地方</li>
                    </ul>
                `;
            } else if (grandTotal >= 70) {
                analysisClass = 'result-box-yellow';
                analysisHTML = `
                    <h2 class="text-2xl font-bold text-yellow-700 mb-2 flex items-center gap-2">
                        <span class="text-3xl">🟡</span> 財務安全度：良好 (總分 ${grandTotal} 分)
                    </h2>
                    <p class="text-lg font-semibold text-yellow-800 mb-4 border-b border-yellow-100 pb-2">很棒的開始，你已經走在正確的路上了！</p>
                    <h3 class="font-bold text-yellow-700 mb-2">你現在的狀態是：</h3>
                    <ul class="list-disc list-inside text-yellow-800 space-y-1 mb-4 bg-yellow-50 p-3 rounded">
                        <li>基本的財務管理能力已經有了</li>
                        <li>有些地方還可以更好，但這很正常</li>
                        <li>整體方向是對的，持續下去就對了</li>
                    </ul>
                    <h3 class="font-bold text-yellow-700 mb-2">接下來可以這樣做：</h3>
                    <ul class="list-disc list-inside text-yellow-800 space-y-1">
                        <li>回頭看看你得分比較低的部分，從那邊開始加強會最有效</li>
                        <li>如果想找個社群一起努力，${createLink('8週存款成長營', '8週存款成長營')} 每週都有直播分享，可以獲得更多支持</li>
                        <li>${createLink('60天存款成長計畫', '60天存款成長計畫')} 很適合你現在的階段，可以讓財務基礎更穩固</li>
                    </ul>
                `;
            } else if (grandTotal >= 50) {
                analysisClass = 'result-box-orange';
                analysisHTML = `
                    <h2 class="text-2xl font-bold text-orange-700 mb-2 flex items-center gap-2">
                        <span class="text-3xl">🟠</span> 財務安全度：待加強 (總分 ${grandTotal} 分)
                    </h2>
                    <p class="text-lg font-semibold text-orange-800 mb-4 border-b border-orange-100 pb-2">你很有潛力！願意開始關注家庭財務，這一步很重要。</p>
                    <h3 class="font-bold text-orange-700 mb-2">你現在的狀態是：</h3>
                    <ul class="list-disc list-inside text-orange-800 space-y-1 mb-4 bg-orange-50 p-3 rounded">
                        <li>已經意識到理財的重要性了（這真的很重要！）</li>
                        <li>需要更有系統的學習和實際操作</li>
                        <li>先建立基本的安全網，會讓你安心很多</li>
                    </ul>
                    <h3 class="font-bold text-orange-700 mb-2">建議你可以這樣開始：</h3>
                    <ul class="list-disc list-inside text-orange-800 space-y-1">
                        <li>先從記帳開始，不用很複雜，就是先知道錢都跑去哪裡了</li>
                        <li>慢慢建立緊急預備金，這會大大增加你的安全感</li>
                        <li>${createLink('家庭理財必修課', '家庭理財必修課')} 很適合新手，可以很系統地學習理財規劃</li>
                        <li>或是從閱讀開始，《家計力》這本書不錯，也可以加入 ${createLink('家計力聊書會', '家計力聊書會')}，跟其他媽媽一起學習</li>
                    </ul>
                `;
            } else {
                analysisClass = 'result-box-red';
                analysisHTML = `
                    <h2 class="text-2xl font-bold text-red-700 mb-2 flex items-center gap-2">
                        <span class="text-3xl">🔴</span> 財務安全度：需關注 (總分 ${grandTotal} 分)
                    </h2>
                    <p class="text-lg font-semibold text-red-800 mb-4 border-b border-red-100 pb-2">別擔心，每個人都有起點，現在開始就是最好的時機。</p>
                    <h3 class="font-bold text-red-700 mb-2">你現在的狀態是：</h3>
                    <ul class="list-disc list-inside text-red-800 space-y-1 mb-4 bg-red-50 p-3 rounded">
                        <li>財務基礎需要從頭建立，但這完全沒問題</li>
                        <li>可能正面臨一些經濟壓力，我懂那種感覺</li>
                        <li>需要一個溫和但有系統的改善計畫，一步一步來</li>
                    </ul>
                    <h3 class="font-bold text-red-700 mb-2">建議你可以這樣做：</h3>
                    <ul class="list-disc list-inside text-red-800 space-y-1">
                        <li>不要給自己太大壓力，從最小的目標開始就好</li>
                        <li>先處理最急迫的問題，其他的慢慢來</li>
                        <li>可以從 ${createLink('家計力聊書會', '家計力聊書會')} 開始，跟其他媽媽一起學習，你會發現原來大家都有類似的困擾</li>
                        <li>${createLink('8週存款成長營', '8週存款成長營')} 的社群很溫暖，每週都有直播分享實用的存錢記帳小技巧，可以獲得同儕支持</li>
                    </ul>
                `;
            }

            // 新增：雷達圖 Canvas 容器
            resultHTML += `
                <div class="chart-container">
                    <canvas id="radarChart"></canvas>
                </div>
            `;

            // 插入總結方塊
            resultHTML += `<section class="result-box ${analysisClass}">${analysisHTML}</section>`;

            // 3. 產生詳細的「依據得分重點加強建議」
            let adviceItems = [];

            if (scores.A.total < 15) {
                adviceItems.push(`
                    <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded-r-lg mb-4">
                        <h3 class="text-lg font-bold text-red-800 mb-2">🏗️ A項得分低於15：需要提升收支掌控力</h3>
                        <p class="text-gray-700 mb-3">如果你覺得錢常常莫名其妙就不見了，那就從這裡開始吧！</p>
                        
                        <div class="mb-3">
                            <span class="font-bold text-gray-800 block mb-1">現在最需要做的：</span>
                            <p class="text-gray-700">先建立基礎的財務管理習慣</p>
                        </div>
                        
                        <div class="mb-3">
                            <span class="font-bold text-gray-800 block mb-1">你可以這樣開始：</span>
                            <ul class="list-disc list-inside text-gray-700 space-y-1 ml-1">
                                <li>開始記帳，真的不用很複雜，用最簡單的方式就好</li>
                                <li>把每個月固定會有的收入和支出列出來，先看清楚全貌</li>
                                <li>給自己設定一個小小的儲蓄目標，不用多，能達成最重要</li>
                            </ul>
                        </div>
                        
                        <div class="bg-red-100 p-3 rounded text-red-800 text-sm">
                            <span class="font-bold">推薦你：</span>
                            加入 ${createLink('8週存款成長營', '8週存款成長營')}，裡面有很多媽媽跟你一樣正在學記帳，每週三中午還有LiveTalk分享實用技巧
                        </div>
                    </div>
                `);
            }
            if (scores.B.total < 15) {
                adviceItems.push(`
                    <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded-r-lg mb-4">
                        <h3 class="text-lg font-bold text-red-800 mb-2">🆘 B項得分低於15：提升緊急應變能力</h3>
                        <p class="text-gray-700 mb-3">如果一想到突發狀況就覺得很不安，那我們先把安全網建起來。</p>
                        
                        <div class="mb-3">
                            <span class="font-bold text-gray-800 block mb-1">現在最需要做的：</span>
                            <p class="text-gray-700">建立家庭財務安全網</p>
                        </div>
                        
                        <div class="mb-3">
                            <span class="font-bold text-gray-800 block mb-1">你可以這樣開始：</span>
                            <ul class="list-disc list-inside text-gray-700 space-y-1 ml-1">
                                <li>先開一個專門的緊急金帳戶，慢慢存也沒關係</li>
                                <li>看看家裡的保險夠不夠，保障有沒有缺口</li>
                                <li>了解一下政府有哪些補助和資源可以用</li>
                            </ul>
                        </div>
                        
                        <div class="bg-red-100 p-3 rounded text-red-800 text-sm">
                            <span class="font-bold">推薦你：</span>
                            找MomPower的家庭財務規劃師聊聊，他們會幫你看看安全網要怎麼建立比較適合你家
                        </div>
                    </div>
                `);
            }
            if (scores.C.total < 15) {
                adviceItems.push(`
                    <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded-r-lg mb-4">
                        <h3 class="text-lg font-bold text-red-800 mb-2">🔮 C項得分低於15：未來規劃準備不足</h3>
                        <p class="text-gray-700 mb-3">知道要規劃未來，但不知道從哪裡開始？我們懂那種茫然的感覺。</p>
                        
                        <div class="mb-3">
                            <span class="font-bold text-gray-800 block mb-1">現在最需要做的：</span>
                            <p class="text-gray-700">開始進行長期財務規劃</p>
                        </div>
                        
                        <div class="mb-3">
                            <span class="font-bold text-gray-800 block mb-1">你可以這樣開始：</span>
                            <ul class="list-disc list-inside text-gray-700 space-y-1 ml-1">
                                <li>先設定一個明確的理財目標，有目標才知道要往哪裡走</li>
                                <li>開始了解一些基本的投資概念，不用急著做，先知道就好</li>
                                <li>幫孩子開個教育基金帳戶，從紅包開始存也可以</li>
                            </ul>
                        </div>
                        
                        <div class="bg-red-100 p-3 rounded text-red-800 text-sm">
                            <span class="font-bold">推薦你：</span>
                            ${createLink('家庭理財必修課', '家庭理財必修課')} 很適合想要系統性學習的媽媽。
                        </div>
                    </div>
                `);
            }
            if (scores.D.total < 15) {
                adviceItems.push(`
                    <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded-r-lg mb-4">
                        <h3 class="text-lg font-bold text-red-800 mb-2">💝 D項得分低於15：常常焦慮金錢不足</h3>
                        <p class="text-gray-700 mb-3">如果你常常因為錢而焦慮、睡不好，我想先給你一個擁抱。</p>
                        
                        <div class="mb-3">
                            <span class="font-bold text-gray-800 block mb-1">現在最需要做的：</span>
                            <p class="text-gray-700">與其一直焦慮，不如開始學習正確認識金錢</p>
                        </div>
                        
                        <div class="mb-3">
                            <span class="font-bold text-gray-800 block mb-1">你可以這樣開始：</span>
                            <ul class="list-disc list-inside text-gray-700 space-y-1 ml-1">
                                <li>練習感恩目前已經擁有的資源，把注意力放在「有」而不是「沒有」</li>
                                <li>設定一些小目標，慢慢累積成功經驗，會讓你比較有信心</li>
                                <li>學一些壓力管理和放鬆的技巧，照顧好自己很重要</li>
                            </ul>
                        </div>
                        
                        <div class="bg-red-100 p-3 rounded text-red-800 text-sm">
                            <span class="font-bold">推薦你：</span>
                            可以聽聽 ${createLink('精算媽咪的家計簿 Podcast', '精算媽咪的家計簿 Podcast')} 節目，珊迪兔會分享很多心態調整的內容，也可以多看看部落格裡相關的文章
                        </div>
                    </div>
                `);
            }
            if (scores.E.total < 15) {
                adviceItems.push(`
                    <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded-r-lg mb-4">
                        <h3 class="text-lg font-bold text-red-800 mb-2">📚 E項得分低於15：理財知識開放度過低</h3>
                        <p class="text-gray-700 mb-3">覺得理財很複雜、很難懂嗎？其實只是還沒找到適合的學習方式。</p>
                        
                        <div class="mb-3">
                            <span class="font-bold text-gray-800 block mb-1">現在最需要做的：</span>
                            <p class="text-gray-700">練習用開放的心態，了解理財規劃與常見工具</p>
                        </div>
                        
                        <div class="mb-3">
                            <span class="font-bold text-gray-800 block mb-1">你可以這樣開始：</span>
                            <ul class="list-disc list-inside text-gray-700 space-y-1 ml-1">
                                <li>每週學一個理財概念就好，不用貪多，慢慢來</li>
                                <li>加入理財學習社群，跟大家一起學會比較不孤單</li>
                                <li>從最基礎的開始，不要跳太快</li>
                            </ul>
                        </div>
                        
                        <div class="bg-red-100 p-3 rounded text-red-800 text-sm">
                            <span class="font-bold">推薦你：</span>
                            ${createLink('60天存款成長計畫', '60天存款成長計畫')} 會有教練陪著你，一步一步帶你建立理財知識，不會讓你覺得很難
                        </div>
                    </div>
                `);
            }
            if (scores.F.total < 15) {
                adviceItems.push(`
                    <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded-r-lg mb-4">
                        <h3 class="text-lg font-bold text-red-800 mb-2">👫 F項得分低於15：家庭財務缺乏良好溝通</h3>
                        <p class="text-gray-700 mb-3">跟另一半談錢總是談不攏，或是根本不敢談？這真的是很多家庭的困擾。</p>
                        
                        <div class="mb-3">
                            <span class="font-bold text-gray-800 block mb-1">現在最需要做的：</span>
                            <p class="text-gray-700">建立良好的金錢溝通模式</p>
                        </div>
                        
                        <div class="mb-3">
                            <span class="font-bold text-gray-800 block mb-1">你可以這樣開始：</span>
                            <ul class="list-disc list-inside text-gray-700 space-y-1 ml-1">
                                <li>跟另一半約好定期開個財務會議，不用很正式，喝個茶聊一聊就好</li>
                                <li>學一些非暴力溝通的技巧，會讓談話更順利</li>
                                <li>試著分享彼此的理財目標和擔憂，互相理解很重要</li>
                            </ul>
                        </div>
                        
                        <div class="bg-red-100 p-3 rounded text-red-800 text-sm">
                            <span class="font-bold">我推薦你：</span>
                            可以多看看部落格裡夫妻理財溝通相關的文章，會有很多實用的技巧
                        </div>
                    </div>
                `);
            }
            if (scores.G.total < 15) {
                adviceItems.push(`
                    <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded-r-lg mb-4">
                        <h3 class="text-lg font-bold text-red-800 mb-2">🤝 G項得分低於15：無外部系統</h3>
                        <p class="text-gray-700 mb-3">一個人摸索真的很累，有時候需要一些外援和陪伴。</p>
                        
                        <div class="mb-3">
                            <span class="font-bold text-gray-800 block mb-1">現在最需要做的：</span>
                            <p class="text-gray-700">建立理財學習支持網絡</p>
                        </div>
                        
                        <div class="mb-3">
                            <span class="font-bold text-gray-800 block mb-1">你可以這樣開始：</span>
                            <ul class="list-disc list-inside text-gray-700 space-y-1 ml-1">
                                <li>加入理財學習社群，你會發現很多人跟你有一樣的困擾</li>
                                <li>找到可以信任的理財資訊來源，不要被一些不實資訊誤導</li>
                                <li>不要害怕尋求專業協助，有人幫忙真的會快很多</li>
                            </ul>
                        </div>
                        
                        <div class="bg-red-100 p-3 rounded text-red-800 text-sm">
                            <span class="font-bold">我推薦你：</span>
                            加入 ${createLink('8週存款成長營', '8週存款成長營')} 社群，每週三中午有LiveTalk，還可以跟其他媽媽交流，互相打氣
                        </div>
                    </div>
                `);
            }

            if (adviceItems.length > 0) {
                specificAdvice = `
                    <section class="result-box bg-white mt-6">
                        <h2 class="text-2xl font-bold text-red-800 mb-2">🎯 依據得分重點加強建議</h2>
                        <p class="mb-6 text-gray-700">看看你的A、B、C、D、E、F、G得分低於15的需要特別注意：</p>
                        <div class="space-y-6">
                            ${adviceItems.join('')}
                        </div>
                    </section>
                `;
            }

            resultHTML += specificAdvice;

            // --------------------------
            // 4. 插入結果並顯示
            // --------------------------
            const resultsElement = document.getElementById('results');
            resultsElement.innerHTML = resultHTML;
            resultsElement.classList.remove('hidden');
            
            // 確保在結果顯示後，移除隱藏 class
            document.getElementById('actionPlanSection').classList.remove('hidden');
            document.getElementById('encouragementSection').classList.remove('hidden');
            document.getElementById('downloadButton').classList.remove('hidden');

            // 滾動到結果位置
            resultsElement.scrollIntoView({ behavior: 'smooth', block: 'start' });

            // --------------------------
            // 5. 繪製雷達圖 (手機版修正)
            // --------------------------
            const ctx = document.getElementById('radarChart').getContext('2d');
            
            // 如果已經有圖表實例，先銷毀它，避免重複繪製
            if (radarChartInstance) {
                radarChartInstance.destroy();
            }

            // 偵測是否為手機裝置 (寬度小於 640px)
            const isMobile = window.innerWidth < 640;

            const chartData = {
                labels: [
                    'A. 收支掌控力',
                    // 如果是手機版，可以考慮把長標籤拆行，但 Chart.js 處理中文換行有時需陣列
                    // 這裡先簡單用較短的文字，或是靠 padding 解決
                    isMobile ? ['B. 緊急', '應變能力'] : 'B. 緊急應變能力',
                    'C. 未來規劃', 
                    'D. 金錢安心感',
                    'E. 理財知識',
                    'F. 家庭溝通',
                    'G. 外部資源'
                ],
                datasets: [{
                    label: '財務健檢得分',
                    data: [
                        scores.A.total,
                        scores.B.total,
                        scores.C.total,
                        scores.D.total,
                        scores.E.total,
                        scores.F.total,
                        scores.G.total
                    ],
                    fill: true,
                    backgroundColor: 'rgba(248, 129, 55, 0.2)', // 透明橘色背景
                    borderColor: '#f88137', // 橘色邊框
                    pointBackgroundColor: '#f88137',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: '#f88137'
                }]
            };

            const chartConfig = {
                type: 'radar',
                data: chartData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    // 【關鍵修正】增加 layout padding，避免文字被切邊
                    layout: {
                        padding: {
                            top: 10,
                            bottom: 10,
                            left: 10,
                            right: 10 // 右側多留空間給「緊急應變能力」
                        }
                    },
                    scales: {
                        r: {
                            min: 0,
                            max: 25, 
                            ticks: {
                                stepSize: 5,
                                font: { size: 12 },
                                color: '#666',
                                backdropColor: 'transparent' // 讓刻度背景透明，比較美觀
                            },
                            pointLabels: {
                                font: {
                                    size: isMobile ? 11 : 14, // 手機版字體縮小
                                    family: "'Noto Sans TC', sans-serif"
                                },
                                color: '#431407' 
                            },
                            grid: {
                                color: '#e5e7eb' 
                            },
                            angleLines: {
                                color: '#e5e7eb'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false 
                        }
                    }
                }
            };

            radarChartInstance = new Chart(ctx, chartConfig);
        }
    </script>
</body>
</html>